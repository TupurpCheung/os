### 30天自制操作系统实践



#### 第一天
+ 程序的起始部分是固定的，是因为对于FAT12格式的软盘而言，必须以这个代码开头
+ 软盘共有两个磁头（即有两面），每面都有80个柱面（由外向内的圆，柱面依次为0、1、...79），每个柱面有18个扇区，每个扇区的大小为512bytes
+ 所以一个软盘的大小为 2 * 512 * 80 * 18 = 1440KB = 1.44MB 
+ 而BIOS主板在加载软盘的第一个扇区时，如果第一个扇区最后两个字节是`55AA`，则认为此扇区为启动区（IPL）
+ 启动区太小了，根本无法装下操作系统，所以都是启动区去加载真正的操作系统

#### 第二天
+ 寄存器
  + AX 累加寄存器
 + CX 计数寄存器
 + DX 数据寄存器
 + BX 基址寄存器
 + SP 栈指针寄存器
 + BP 基址指寄存器
 + SI 源地址寄存器
 + DI 目的地址寄存器
 
+ 段寄存器
 + ES 附加段寄存器
 + CS 代码段寄存器
 + SS 栈段寄存器
 + DS 数据段寄存器

+ 为什么是0x7C00
内存中的地址也并不是可以随便使用的，总之IBM规定了0x7c00-0x7dff这512字节地址用来存放启动区的内容

#### 第三天
+ INT 0x13 中断，用于磁盘读、写、扇区校验（verify），以及寻道（seek）
+ JC 如果进位是1，就跳转
+ JNC 如果进位不是1，就跳转
+ C0-H0-S1的含义
 + C，cylinder-柱面0，从0开始，共80个柱面
 + H，head-磁头，从0开始，共两个磁头
 + S，sector-扇区，从1开始，共18个扇区
+ 段寄存器寻址`ES:BX`，真正的地址为 `ES*16  + BX`
+ BIOS将软盘的第一个扇区，即启动区（IPL）加载到内存0x7c00到0x7dff处
+ 启动区（IPL）把软盘的前10个柱面加载到内存的0x8000处
+ 记住：0x8000到0x8200的位置存放的是启动区(IPL的内容)，并不属于真正操作系统的一部分
+ 作者为何使用0x8000以后的内存，纯粹是因为这个地方没有别的程序使用
+ 一般向一个空软盘保存文件时，文件的内容会写在0x4200以后的地方
+ 假设软盘上0x4200以后的地方是我们真正的操作系统，且软盘的前10个柱面被加载到了内存0x8000处，则操作系统在内存中的位置为0x8000+0x4200=`0xc200`处
